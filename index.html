<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- DEVELOPER NOTE: Merge conflict resolved.
         This root index.html is now a very simple landing page.
         The primary, feature-rich entry point for the entire repository is `home.html`.
         The complex CRAFT SPA that was previously part of a conflict in this file will be moved to `corporate-credit-risk-analyst-training/index.html`.
         The original simpler CRAFT loader (sidebar + markdown viewer) is kept here as a basic fallback,
         but its primary purpose is now to redirect to home.html.
         The large commented-out CRAFT SPA block has been removed as of [current date/change] as it now resides in corporate-credit-risk-analyst-training/index.html.
    -->
    <title>Financial Learning Repository - Welcome</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        body { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 90vh; text-align: center; }
        .redirect-container { padding: 20px; border: 1px solid #ccc; border-radius: 8px; background-color: #f9f9f9; }
        .redirect-container h1 { margin-bottom: 15px; }
        .redirect-container p { margin-bottom: 20px; }
        .redirect-link {
            display: inline-block;
            padding: 12px 25px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-size: 1.1em;
            transition: background-color 0.3s;
        }
        .redirect-link:hover {
            background-color: #0056b3;
        }
        .fallback-content { margin-top: 30px; padding-top: 20px; border-top: 1px dashed #eee; }
    </style>
</head>
<body>
    <div class="redirect-container">
        <h1>Welcome to the Financial Learning Repository</h1>
        <p>This site hosts a comprehensive collection of resources for financial education, including credit risk analysis, CFA program preparation, financial modeling, and more.</p>
        <p><strong>For the best experience and full site navigation, please visit our main dashboard:</strong></p>
        <a href="home.html" class="redirect-link">Go to Main Dashboard (home.html)</a>
    </div>

    <div class="fallback-content container" style="display:none;"> <!-- Initially hide fallback -->
        <header>
            <h1>CRAFT – Credit Risk Analyst Foundations Training (Fallback View)</h1>
        </header>
        <nav id="sidebar">
            <h2>Course Modules</h2>
            <ul id="module-navigation-list">
                <!-- Dynamically populated by script.js if this part becomes active -->
                <li><a href="#" data-path="corporate-credit-risk-analyst-training/README.md">Course Overview (CRAFT README)</a></li>
                 <li><a href="corporate-credit-risk-analyst-training/index.html">Go to Interactive CRAFT Hub</a></li>
            </ul>
        </nav>
        <main id="content-area">
            <p>Please use the <a href="home.html">Main Dashboard</a> for full site access. If you intended to view the CRAFT program, its interactive hub is at <a href="corporate-credit-risk-analyst-training/index.html">corporate-credit-risk-analyst-training/index.html</a>.</p>
        </main>
        <footer>
            <p>&copy; <span id="current-year"></span> Financial Learning Hub. Placeholder.</p>
        </footer>
    </div>

    <!-- Marked.js for Markdown to HTML conversion (for fallback) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Custom JavaScript (for fallback) -->
    <script src="assets/js/script.js"></script>
    <script>
        // Adding a simple current year for the fallback footer.
        const currentYearSpan = document.getElementById('current-year');
        if (currentYearSpan) {
            currentYearSpan.textContent = new Date().getFullYear();
        }
        // Auto-redirect to home.html after a short delay
        setTimeout(function() {
            if (window.location.pathname.endsWith('/') || window.location.pathname.endsWith('index.html')) {
                 // window.location.href = 'home.html'; // Automatic redirect can be enabled here
                 console.log("Automatic redirect to home.html is currently disabled for review purposes of index.html.");
            }
        }, 100);
    </script>
</body>
</html>


<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Financial Learning Hub - Enhanced</title>
    
    <!-- Tailwind CSS for utility-first styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* --- Base Styles & Modern Color Palette --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* Slate 100 - A slightly richer background */
            color: #1e293b; /* Slate 800 */
        }

        /* --- Animations --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        
        /* --- Scrollbar --- */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #e2e8f0; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }

        /* --- Main Navigation Tabs --- */
        .nav-button {
            position: relative;
            padding: 1rem 0.5rem;
            font-weight: 600;
            color: #475569; /* Slate 600 */
            transition: color 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .nav-button:hover { color: #1e293b; }
        .nav-button.active {
            color: #4338ca; /* Indigo 700 */
            border-bottom-color: #4338ca; /* Indigo 700 */
        }

        /* --- Enhanced Card Styles --- */
        .content-card {
            background-color: #ffffff;
            border-radius: 0.75rem; /* 12px */
            border: 1px solid #e2e8f0; /* Slate 200 */
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
        }
        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 4px 10px -4px rgba(0, 0, 0, 0.07);
        }
        
        /* --- Interactive Module List --- */
        .module-card {
            cursor: pointer;
            border-left-width: 4px;
            border-color: #cbd5e1;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .module-card:hover {
            background-color: #f1f5f9;
            border-left-color: #64748b;
        }
        .module-card.active {
            background-color: #eef2ff;
            border-left-color: #4f46e5;
            font-weight: 600;
        }

        /* --- Helper for SPA view management --- */
        .content-section:not(.active) { display: none; }

        /* --- Sidebar Styles --- */
        .sidebar { transition: transform 0.3s ease-in-out; }
        @media (max-width: 1023px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.open { transform: translateX(0); }
        }

        /* --- Progress Bar --- */
        .progress-bar {
            background-color: #e2e8f0; /* Slate 200 */
            border-radius: 9999px;
            overflow: hidden;
        }
        .progress-bar-inner {
            background-color: #4ade80; /* Green 400 */
            height: 100%;
            transition: width 0.5s ease-in-out;
            border-radius: 9999px;
        }

        /* --- Filter Buttons --- */
        .filter-btn {
            transition: all 0.2s ease;
        }
        .filter-btn.active {
            background-color: #4338ca !important;
            color: #ffffff !important;
        }
    </style>
</head>
<body class="antialiased">
    <div class="relative min-h-screen lg:flex">
        <!-- === MOBILE HEADER & SIDEBAR TOGGLE === -->
        <header class="lg:hidden sticky top-0 bg-white/80 backdrop-blur-md z-30 flex items-center justify-between p-4 border-b border-slate-200">
            <h2 class="font-bold text-lg text-slate-800">Financial Hub</h2>
            <button id="menu-toggle" class="p-2 rounded-md hover:bg-slate-100" aria-label="Open menu"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button>
        </header>

        <!-- === SIDEBAR === -->
        <aside id="sidebar" class="sidebar fixed top-0 left-0 h-full w-64 bg-white border-r border-slate-200 z-40 lg:relative lg:translate-x-0">
            <div class="p-6 flex flex-col h-full">
                <h1 class="text-2xl font-bold text-slate-900">Learning Hubs</h1>
                <div class="relative mt-6">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3"><svg class="w-5 h-5 text-slate-400" viewBox="0 0 24 24" fill="none"><path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span>
                    <input type="text" placeholder="Search hubs..." class="w-full py-2 pl-10 pr-4 text-slate-700 bg-slate-100 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <nav class="mt-6 space-y-2 flex-1">
                    <a href="#" class="flex items-center px-4 py-2.5 text-white bg-indigo-600 rounded-lg font-semibold" aria-current="page"><svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"></path></svg>Finance Hub</a>
                    <a href="#" class="flex items-center px-4 py-2.5 text-slate-600 hover:bg-slate-100 hover:text-slate-900 rounded-lg font-medium"><svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>Data Science Hub</a>
                    <a href="#" class="flex items-center px-4 py-2.5 text-slate-600 hover:bg-slate-100 hover:text-slate-900 rounded-lg font-medium"><svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"></path></svg>Cloud Computing Hub</a>
                </nav>
                 <div class="mt-4">
                    <a href="#" class="flex items-center p-3 text-slate-600 hover:bg-slate-100 rounded-lg"><svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>Logout</a>
                </div>
            </div>
        </aside>
        
        <div id="sidebar-backdrop" class="fixed inset-0 bg-black/30 z-30 hidden lg:hidden"></div>

        <div class="flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto">
            <nav class="flex justify-center border-b border-slate-300 mb-8" role="tablist" aria-label="Learning Paths">
                <div class="flex flex-wrap justify-center space-x-2 md:space-x-6">
                    <button role="tab" id="tab-dashboard" data-view="dashboard" class="nav-button active">Dashboard</button>
                    <button role="tab" id="tab-creditAnalyst" data-view="creditAnalyst" class="nav-button">Credit Analyst Path</button>
                    <button role="tab" id="tab-cfaCandidate" data-view="cfaCandidate" class="nav-button">CFA® Candidate Path</button>
                    <button role="tab" id="tab-explorer" data-view="explorer" class="nav-button">Explorer Path</button>
                </div>
            </nav>

            <main id="mainContent">
                <!-- 1. DASHBOARD VIEW -->
                <section id="view-dashboard" class="content-section active space-y-8" role="tabpanel" aria-labelledby="tab-dashboard">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2 content-card p-8 flex flex-col justify-center bg-indigo-700 text-white">
                            <h2 class="text-3xl font-bold mb-2">Welcome Back!</h2>
                            <p class="text-indigo-200 text-lg">Let's continue your journey to mastering finance. Pick up where you left off or explore something new.</p>
                            <a href="#" class="mt-6 bg-white text-indigo-700 font-bold py-2 px-5 rounded-lg self-start hover:bg-indigo-50">Continue Last Module</a>
                        </div>
                        <div class="content-card p-6">
                            <h3 class="font-semibold text-lg mb-4 text-slate-800">Your Progress</h3>
                            <div id="dashboard-progress" class="space-y-4"></div>
                        </div>
                    </div>
                    
                    <div class="content-card p-6">
                        <h3 class="font-semibold text-lg mb-4 text-slate-800">Explore Learning Resources</h3>
                         <div id="resource-filters" class="flex flex-wrap gap-2 mb-6"></div>
                        <div id="resource-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                    </div>
                </section>

                <!-- 2. CREDIT ANALYST PATH VIEW -->
                <section id="view-creditAnalyst" class="content-section" role="tabpanel" aria-labelledby="tab-creditAnalyst">
                     <div class="text-center max-w-3xl mx-auto mb-12">
                         <h2 class="text-3xl font-bold text-slate-800 mb-4">Credit Analyst Learning Path (CRAFT)</h2>
                         <p class="text-slate-600 text-lg">A comprehensive, 11-module program taking you from foundational principles to advanced, specialized topics.</p>
                    </div>
                    <div class="lg:flex gap-8">
                        <aside class="lg:w-2/5 mb-8 lg:mb-0">
                            <h3 class="font-semibold text-xl mb-4 text-slate-800">CRAFT Program Modules</h3>
                            <div id="creditRiskModules" class="space-y-2"></div>
                        </aside>
                        <div class="lg:w-3/5"><div id="creditRiskModuleDetail" class="content-card p-6 lg:sticky top-8"></div></div>
                    </div>
                </section>

                <!-- 3. CFA CANDIDATE PATH VIEW -->
                <section id="view-cfaCandidate" class="content-section" role="tabpanel" aria-labelledby="tab-cfaCandidate">
                    <div class="text-center max-w-3xl mx-auto mb-12"><h2 class="text-3xl font-bold text-slate-800 mb-4">CFA® Candidate Path</h2><p class="text-slate-600 text-lg">Navigate your CFA journey with a toolkit designed for success. Explore focused resources below.</p></div>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="content-card p-6 lg:col-span-2">
                            <h3 class="font-semibold text-xl mb-6 text-slate-800">Resource Toolkit by Type</h3>
                            <div class="mb-6"><div id="cfaResourceFilters" class="flex flex-wrap gap-3"></div></div>
                            <div id="cfaResourceContent" class="min-h-[150px]"></div>
                        </div>
                        <div class="content-card p-6"><h3 class="font-semibold text-xl mb-4 text-center text-slate-800">Ethics Exam Weighting</h3><p class="text-slate-600 text-center text-sm mb-4">Ethics holds significant weight (10-15%) on all exams.</p><div class="relative h-64"><canvas id="ethicsChart"></canvas></div></div>
                    </div>
                </section>
                
                <!-- 4. EXPLORER PATH VIEW -->
                <section id="view-explorer" class="content-section" role="tabpanel" aria-labelledby="tab-explorer">
                     <div class="text-center max-w-3xl mx-auto mb-12"><h2 class="text-3xl font-bold text-slate-800 mb-4">The Explorer Path</h2><p class="text-slate-600 text-lg">Perfect for newcomers. Pick and choose topics to build your financial fluency.</p></div>
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                        <div class="content-card p-8 flex flex-col items-center"><div class="w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mb-4"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div><h3 class="font-semibold text-xl text-slate-800">1. Market Quick Start</h3><p class="text-slate-600 mt-2 text-sm flex-1">Learn essential market terms and valuation rules.</p><a href="#" class="mt-4 font-semibold text-indigo-600 text-sm">Start Learning &rarr;</a></div>
                        <div class="content-card p-8 flex flex-col items-center"><div class="w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mb-4"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><h3 class="font-semibold text-xl text-slate-800">2. Behavioral Insights</h3><p class="text-slate-600 mt-2 text-sm flex-1">Understand the psychology influencing market behavior.</p><a href="#" class="mt-4 font-semibold text-indigo-600 text-sm">Explore Biases &rarr;</a></div>
                        <div class="content-card p-8 flex flex-col items-center"><div class="w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mb-4"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg></div><h3 class="font-semibold text-xl text-slate-800">3. Industry Primers</h3><p class="text-slate-600 mt-2 text-sm flex-1">Dive into sectors like Technology, Healthcare, and Energy.</p><a href="#" class="mt-4 font-semibold text-indigo-600 text-sm">View Primers &rarr;</a></div>
                     </div>
                </section>
            </main>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- 1. DATA STORE ---
        const appData = {
            userProgress: {
                creditRisk: 65,
                cfaPrep: 30,
                modeling: 80
            },
            resources: [
                { id: 'r1', title: 'Corporate Credit Risk (CRAFT)', description: 'Full 11-module curriculum.', category: 'Core Program', link: '#'},
                { id: 'r2', title: 'CFA® Program Prep', description: 'Study hub for all three levels.', category: 'Core Program', link: '#'},
                { id: 'r3', title: 'Financial Modeling', description: 'Best practices, templates, and valuation.', category: 'Skill Building', link: '#'},
                { id: 'r4', title: 'Industry Primers', description: 'Insights into 15+ key sectors.', category: 'Special Topics', link: '#'},
                { id: 'r5', title: 'Market Analysis Quick Start', description: 'Learn market jargon and rules of thumb.', category: 'Skill Building', link: '#'},
                { id: 'r6', title: 'Behavioral Finance', description: 'Understand cognitive biases in markets.', category: 'Special Topics', link: '#'},
                { id: 'r7', title: 'Fintech Innovations', description: 'Explore AI, Blockchain, and Open Banking.', category: 'Special Topics', link: '#'},
                { id: 'r8', title: 'Risk Management Frameworks', description: 'Governance, reporting, and risk types.', category: 'Skill Building', link: '#'},
            ],
            creditRisk: {
                modules: [
                    { id: 'm1', title: '01: Foundations', content: 'Covers accounting and financial modeling basics.', link: '#' },
                    { id: 'm2', title: '02: Understanding the Market', content: 'Explores capital markets and industry analysis.', link: '#' },
                    { id: 'm3', title: '03: The Analyst\'s Craft', content: 'Develops crucial soft skills for credit narratives.', link: '#' },
                    { id: 'm4', title: '04: The Credit Lifecycle', content: 'Covers underwriting, LBO & M&A analysis.', link: '#' },
                    { id: 'm5', title: '05: Future of Risk Management', content: 'Forward-looking module on AI in risk management.', link: '#' },
                    { id: 'm6', title: '06: Advanced Topics', content: 'Deep dives into QoE and debt structuring.', link: '#' },
                ]
            },
            cfaResources: {
                deepDives: { title: 'Topic Deep Dives', content: 'In-depth explorations of complex curriculum areas.', link: '#' },
                cheatSheets: { title: 'Concise Cheat Sheets', content: 'Quick summaries of formulas and concepts.', link: '#' },
                practiceExams: { title: 'Practice Exams', content: 'Simulate exam conditions for all levels.', link: '#' },
                caseStudies: { title: 'Practical Case Studies', content: 'Apply theory to realistic scenarios.', link: '#' },
            }
        };

        // --- 2. DOM ELEMENT SELECTORS ---
        const elements = {
            navButtons: document.querySelectorAll('.nav-button'),
            contentSections: document.querySelectorAll('.content-section'),
            creditRiskModulesContainer: document.getElementById('creditRiskModules'),
            creditRiskModuleDetailContainer: document.getElementById('creditRiskModuleDetail'),
            cfaResourceFiltersContainer: document.getElementById('cfaResourceFilters'),
            cfaResourceContentContainer: document.getElementById('cfaResourceContent'),
            ethicsChartCanvas: document.getElementById('ethicsChart'),
            sidebar: document.getElementById('sidebar'),
            menuToggle: document.getElementById('menu-toggle'),
            sidebarBackdrop: document.getElementById('sidebar-backdrop'),
            dashboardProgress: document.getElementById('dashboard-progress'),
            resourceGrid: document.getElementById('resource-grid'),
            resourceFilters: document.getElementById('resource-filters'),
        };

        // --- 3. RENDERING & LOGIC FUNCTIONS ---
        const switchView = (viewId) => {
            elements.contentSections.forEach(s => s.classList.remove('active'));
            const targetView = document.getElementById(`view-${viewId}`);
            if(targetView) {
                targetView.classList.add('active');
                targetView.classList.remove('fade-in');
                void targetView.offsetWidth;
                targetView.classList.add('fade-in');
            }
            elements.navButtons.forEach(b => {
                const isActive = b.dataset.view === viewId;
                b.classList.toggle('active', isActive);
                b.setAttribute('aria-selected', isActive);
            });
        };

        const renderDashboardProgress = () => {
            if (!elements.dashboardProgress) return;
            const progressData = [
                { label: 'Credit Risk Path', percent: appData.userProgress.creditRisk },
                { label: 'CFA Prep', percent: appData.userProgress.cfaPrep },
                { label: 'Modeling Skills', percent: appData.userProgress.modeling },
            ];
            elements.dashboardProgress.innerHTML = progressData.map(item => `
                <div>
                    <div class="flex justify-between items-end mb-1">
                        <span class="text-sm font-medium text-slate-600">${item.label}</span>
                        <span class="text-sm font-bold text-slate-500">${item.percent}%</span>
                    </div>
                    <div class="progress-bar h-2 w-full"><div class="progress-bar-inner" style="width: ${item.percent}%"></div></div>
                </div>
            `).join('');
        };
        
        const renderResourceGrid = (filter = 'All') => {
            if (!elements.resourceGrid) return;
            const filteredResources = filter === 'All' 
                ? appData.resources 
                : appData.resources.filter(r => r.category === filter);

            elements.resourceGrid.innerHTML = filteredResources.map(res => `
                <a href="${res.link}" class="content-card p-6 block hover:no-underline">
                    <h4 class="font-bold text-lg text-slate-900 mb-2">${res.title}</h4>
                    <p class="text-slate-600 text-sm mb-4">${res.description}</p>
                    <span class="font-semibold text-indigo-600 text-sm">Explore &rarr;</span>
                </a>
            `).join('');
        };
        
        const renderResourceFilters = () => {
            if (!elements.resourceFilters) return;
            const categories = ['All', ...new Set(appData.resources.map(r => r.category))];
            elements.resourceFilters.innerHTML = categories.map(cat => `
                <button class="filter-btn px-4 py-1.5 text-sm font-semibold rounded-full ${cat === 'All' ? 'active bg-indigo-600 text-white' : 'bg-slate-200 text-slate-700 hover:bg-slate-300'}" data-filter="${cat}">
                    ${cat}
                </button>
            `).join('');
        };

        const renderCreditRiskModules = () => {
            if (!elements.creditRiskModulesContainer) return;
            elements.creditRiskModulesContainer.innerHTML = appData.creditRisk.modules.map(m => `<div class="content-card module-card p-4" data-id="${m.id}" role="button" tabindex="0"><h4 class="font-semibold text-slate-800 pointer-events-none">${m.title}</h4></div>`).join('');
        };

        const updateCreditRiskModuleDetail = (moduleId) => {
            if (!elements.creditRiskModuleDetailContainer) return;
            const moduleData = appData.creditRisk.modules.find(m => m.id === moduleId);
            if (moduleData) {
                elements.creditRiskModuleDetailContainer.innerHTML = `<h3 class="font-bold text-2xl mb-3 text-slate-900">${moduleData.title}</h3><p class="text-slate-600 text-base">${moduleData.content}</p><a href="${moduleData.link}" target="_blank" class="inline-block mt-4 font-semibold text-indigo-600 hover:text-indigo-800 text-sm">Learn More &rarr;</a>`;
                document.querySelectorAll('#creditRiskModules .module-card').forEach(c => c.classList.toggle('active', c.dataset.id === moduleId));
            }
        };

        const renderCfaResourceFilters = () => {
            if (!elements.cfaResourceFiltersContainer) return;
            elements.cfaResourceFiltersContainer.innerHTML = Object.keys(appData.cfaResources).map(key => `<button data-filter="${key}" class="px-4 py-2 bg-slate-100 text-slate-700 rounded-full font-medium text-sm hover:bg-slate-200 transition">${appData.cfaResources[key].title}</button>`).join('');
        };
        
        const updateCfaResourceContent = (filter) => {
            if (!elements.cfaResourceContentContainer) return;
            const resource = appData.cfaResources[filter];
            if (resource) {
                elements.cfaResourceContentContainer.innerHTML = `<div class="p-4 bg-slate-50 rounded-lg fade-in border border-slate-200"><h4 class="font-semibold text-lg text-indigo-800 mb-2">${resource.title}</h4><p class="text-slate-700">${resource.content}</p><a href="${resource.link}" target="_blank" class="inline-block mt-3 font-semibold text-indigo-600 hover:text-indigo-800 text-sm">Explore Resources &rarr;</a></div>`;
                document.querySelectorAll('#cfaResourceFilters button').forEach(btn => {
                    const isActive = btn.dataset.filter === filter;
                    btn.classList.toggle('bg-indigo-100', isActive); btn.classList.toggle('text-indigo-800', isActive);
                    btn.classList.toggle('bg-slate-100', !isActive); btn.classList.toggle('text-slate-700', !isActive);
                });
            }
        };

        const initEthicsChart = () => {
            if (!elements.ethicsChartCanvas) return;
            new Chart(elements.ethicsChartCanvas.getContext('2d'), {
                type: 'doughnut', data: { labels: ['Ethics', 'Other Topics'], datasets: [{ data: [12.5, 87.5], backgroundColor: ['#4f46e5', '#e2e8f0'], borderColor: '#fff', borderWidth: 4, hoverOffset: 8 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => `${c.label}: ${c.parsed.toFixed(1)}%` } } } }
            });
        };

        const toggleSidebar = () => {
            elements.sidebar.classList.toggle('open');
            elements.sidebarBackdrop.classList.toggle('hidden');
        };

        // --- 4. EVENT LISTENERS & INITIALIZATION ---
        const setupEventListeners = () => {
            elements.navButtons.forEach(b => b.addEventListener('click', () => switchView(b.dataset.view)));
            if (elements.creditRiskModulesContainer) elements.creditRiskModulesContainer.addEventListener('click', e => { if (e.target.closest('.module-card')) updateCreditRiskModuleDetail(e.target.closest('.module-card').dataset.id); });
            if (elements.cfaResourceFiltersContainer) elements.cfaResourceFiltersContainer.addEventListener('click', e => { if (e.target.tagName === 'BUTTON') updateCfaResourceContent(e.target.dataset.filter); });
            if (elements.resourceFilters) elements.resourceFilters.addEventListener('click', e => {
                if (e.target.tagName === 'BUTTON') {
                    document.querySelectorAll('#resource-filters button').forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');
                    renderResourceGrid(e.target.dataset.filter);
                }
            });
            if (elements.menuToggle) elements.menuToggle.addEventListener('click', toggleSidebar);
            if (elements.sidebarBackdrop) elements.sidebarBackdrop.addEventListener('click', toggleSidebar);
        };

        const initialize = () => {
            renderDashboardProgress();
            renderResourceGrid();
            renderResourceFilters();
            renderCreditRiskModules();
            if (appData.creditRisk.modules.length > 0) updateCreditRiskModuleDetail(appData.creditRisk.modules[0].id);
            renderCfaResourceFilters();
            if (Object.keys(appData.cfaResources).length > 0) updateCfaResourceContent(Object.keys(appData.cfaResources)[0]);
            initEthicsChart();
            setupEventListeners();
            switchView('dashboard'); 
        };
        
        initialize();
    });
    </script>
</body>
</html>
